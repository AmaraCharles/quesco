<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    






    <script>

        var currentUser = {};
        
        
        $(document).ready(async function () {
        
          async function fetchUserInfo() {
          var parsedData = localStorage.getItem('userem')
        
        
          const response = await $.ajax({
            type: "GET",
            url: `https://quesco-sserver.onrender.com/users/${parsedData}`,
            dataType: "json",
            timeout: 30000,
            success: async function (data) {
              console.log("data", data);
              Object.assign(currentUser, data.data)
            },
            error: function () {
              alert(error)
            }
           
          });
        
          return response.data;
        }
        
          const userInfo = await fetchUserInfo();
        
          $('#quantity').val(userInfo.quantity)
          $('#weight').val(userInfo.weight)
          $('#serviceType').val(userInfo.serviceType)
          $('#description').val(userInfo.description)
          $('#receiverName').val(userInfo.receiverName)
          $('#receiverEmail').val(userInfo.receiverEmail)
          $('#receiver').val(userInfo.receiver)
          $('#deliveryDay').val(userInfo.deliveryDay)
          $('#senderName').val(userInfo.senderName)
          $('#shipmentDate').val(userInfo.shipmentDate)
          $('#from').val(userInfo.from)
          $('#to').val(userInfo.to)
          $('#id').val(userInfo.id)
          $('#location').val(userInfo.location)
          $('#title').val(userInfo.title)
         
        
         });
        
            
        async function updateProfile({
    etd,
    eta,
    totalFreight,
    destination,
    paymentMode,
    receiverName,
    receiverEmail,
    receiverAddress,
    deliveryDay,
    senderName,
    senderEmail,
    senderAddress,
    itemType,
    weight,
   mot,
   consignmentDetails,
   
   location
}) {
          console.log(title,
    etd,
    eta,
    totalFreight,
    destination,
    paymentMode,
    receiverName,
    receiverEmail,
    receiverAddress,
    deliveryDay,
    senderName,
    senderEmail,
    senderAddress,
    itemType,
    weight,
   mot,
   consignmentDetails,
   
   location
);
          console.log(currentUser);
        
          const response = await $.ajax({
            type: "PUT",
            url: `https://quesco-sserver.onrender.com/users/${currentUser._id}/profile/update`,
            dataType: "json",
            data: {
    etd,
    eta,
    totalFreight,
    destination,
    paymentMode,
    receiverName,
    receiverEmail,
    receiverAddress,
    deliveryDay,
    senderName,
    senderEmail,
    senderAddress,
    itemType,
    weight,
   mot,
   consignmentDetails,
   
   location
 },
            timeout: 30000,
            success: function () {
              $('.live-section').addClass("alert-primary").text("Profile updated successfully")
        
              setTimeout(function () {$(location).prop('href', './activeusers.html')     
                           }, 1000 * 2)
        
            }
          });
        
          console.log(response);
          return response.data
        }
        
        
        $('#updateBtn').click(async function (e) {
          e.preventDefault();
         var quantity= $('#quantity').val()
         var weight= $('#weight').val()
          var serviceType=$('#serviceType').val()
         var description= $('#description').val()
         var receiverName= $('#receiverName').val()
        var receiverEmail =$('#receiverEmail').val()
        var receiver=  $('#receiver').val()
         var deliveryDay= $('#deliveryDay').val()
        var senderName= $('#senderName').val()
         var shipmentDate= $('#shipmentDate').val()
         var from = $('#from').val()
          var to=  $('#to').val()
         var id= $('#id').val()
         var location = $('#location').val()
        var title=  $('#title').val()
         
        
        
          console.log(balance)
          await updateProfile({ 
    etd,
    eta,
    totalFreight,
    destination,
    paymentMode,
    receiverName,
    receiverEmail,
    receiverAddress,
    deliveryDay,
    senderName,
    senderEmail,
    senderAddress,
    itemType,
    weight,
   mot,
   consignmentDetails,
   
   location
,})
        
        })
        
        
        
        
        
          </script>
        
         
</body>
</html>